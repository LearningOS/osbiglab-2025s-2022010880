# 0515 进展报告

我们经过一周的努力，在排行榜上重回第二的位置，获得了612分。也感谢其他同学的帮助。

## 文件系统相关

- 实现了伪inode生成器，使用文件路径的哈希作为文件的inode，尽可能保证不同文件的inode不同，且inode为非负int，支持获取文件和目录的inode
- 使得 `sys_open`支持 `O_EXCL`标志，即必须创建新文件
- 修复了lwext4_rust没有在调用前加上挂载点前缀的问题，这可能导致某些操作下的NOENT错误
- 修复了axfs路径解析的问题，现在ext4可以正常解析形如 `/foo/./bar/../a`这样的路径了
- 修复了axfs对挂载点的判定问题，现在形如 `/tmp_c`的路径不会再被归到挂载点 `/tmp`下面了
- 缓解了删除已被打开的文件带来的问题

## bug调试相关

- 更新了依赖项 `page_table_multiarch`的版本以修复aarch下对页面是否valid判定错误的问题
- 修正了 `sys_clone`最后两个参数顺序在不同架构下不同的问题
- 使用busywait替代原本的sleep实现，以缓解IPC关闭卡死的问题。目前这个问题在ArceOS的PR上有一位同学试图通过允许嵌套中断的办法来解决，但被郭同学发现存在缺陷，没有在恢复状态时关中断。
- 增大内存以缓解目前存在的内存泄漏问题。已知的execve相关泄漏已被修复，axnamespace相关泄漏正在review，exit相关泄漏正在讨论。
- 在execve时，若程序请求解释器，向解释器传递程序的绝对路径作为参数
- 修复了 `sys_kill`的返回值错误

## OS运行环境相关

- 编写了一个类似于init脚本的testcase_list，以在执行测例前搭建合适的运行库环境
- 将busybox链接到/bin/ls
- 设置 `LD_LIBRARY_PATH`，并拷贝合适的库到指定位置
- 引入 `axalloc`以在运行时监测内存使用情况，以便排查内存泄漏问题
- 合并了 `kernel_elf_parser`的PR，修正了用户程序栈没有正确向16字节对齐的问题
- 引入了signal相关的内容

## 测例和镜像问题反馈相关

非常感谢郑友捷学长对于测例问题和镜像问题的及时修复，以及对我们遇到的问题的耐心解答和细致帮助。

- 反馈了busybox中不合理的 `kill 10`测例，推动其被修改为合理的测例
- 反馈了加入LTP测例后，导致镜像过大的问题，目前加入了不含LTP版的测例，以便调试前面的测例
- 反馈了musl libctest 动态库版本的测例事实上使用了静态链接的问题，这导致测例失去原本的作用，同时dlopen类型的测试无法通过的问题
- 反馈了basic测例脚本内容的问题，以及镜像目录下面存在多余文件影响测试的问题
- 反馈了glibc版本 libctest测例在获取errno时不符合man手册规范的问题，这可能导致无法正常进行评测

## 接下来的规划

全力推进iozone进度，完善proc fs以支持LTP运行。
